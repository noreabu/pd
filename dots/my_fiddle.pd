#N canvas 2212 137 953 801 10;
#X obj 541 626 unpack;
#X msg 447 459 print;
#X obj 541 586 route 1 2 3 4;
#X obj 624 626 unpack;
#X floatatom 624 676 0 0 0 0 - - -;
#X floatatom 638 653 0 0 0 0 - - -;
#X obj 708 626 unpack;
#X floatatom 708 676 0 0 0 0 - - -;
#X floatatom 722 653 0 0 0 0 - - -;
#X msg 565 55 \; pd dsp 1;
#X text 470 49 click here;
#X text 470 71 to start DSP;
#X text 236 14 FIDDLE - pitch estimator and sinusoidal peak finder
;
#X text 18 80 The Fiddle object estimates the pitch and amplitude of
an incoming sound \, both continuously and as a stream of discrete
"note" events. Fiddle optionally outputs a list of detected sinusoidal
peaks used to make the pitch determination. Fiddle is described theoretically
in the 1998 ICMC proceedings \, reprinted on http://man104nfs.ucsd.edu/~mpuckett.
;
#X text 18 180 Fiddle's creation arguments specify an analysis window
size \, the maximum polyphony (i.e. \, the number of simultaneous "pitches"
to try to find) \, the number of peaks in the spectrum to consider
\, and the number of peaks \, if any \, to output "raw." The outlets
give discrete pitch (a number) \, detected attacks in the amplitude
envelope (a bang) \, one or more voices of continuous pitch and amplitude
\, overall amplitude \, and optionally a sequence of messages with
the peaks.;
#X text 18 306 The analysis hop size is half the window size so in
the example shown here \, one analysis is done every 512 samples (11.6
msec at 44K1) \, and the analysis uses the most recent 1024 samples
(23.2 msec at 44K1). The minimum frequency that Fiddle will report
is 2-1/2 cycles per analysis windows \, or about 108 Hz. (just below
MIDI 45.);
#X text 679 545 number of pitch outlets (1-3 \, default 1);
#X text 679 567 number of peaks to find (1-100 \, default 20);
#X text 679 589 number of peaks to output (default 0.);
#X msg 449 237 reattack 100 10;
#X msg 448 292 npartial 7;
#X msg 448 180 vibrato 50 0.5;
#X text 570 101 a low and high amplitude threshold: if signal amplitude
is below the low threshold \, no pitches or peaks are output. The high
threshold is a minimum at which "cooked" outputs may appear.;
#X text 570 162 A period in milliseconds (50) over which the raw pitch
may not deviate more than an interval in half-tones (0.5) from the
average pitch to report it as a note to the "cooked" pitch outlet.
;
#X text 570 223 A period in milliseconds (100) over which a re-attack
is reported if the amplitude rises more than (1) dB. The re-attack
will result in a "bang" in the attack outlet and may give rise to repeated
notes in the cooked pitch output.;
#X text 548 700 individual sinusoidal components;
#X text 555 555 ------ arguments:;
#X msg 450 341 auto 1;
#X msg 450 363 auto 0;
#X msg 449 428 bang;
#X text 571 426 poll current values --- useful if not in auto mode
\,;
#X text 570 284 Higher partials are weighed less strongly than lower
ones in determining the pitch. This specifies the number of the partial
(7) which will be weighted half as strongly as the fundamental.;
#X text 570 345 start and stop "auto" mode (on by default.) If off
\, output only appears on "bang" (poll mode).;
#X text 571 458 print out all settings;
#X text 679 523 window size (128-2048 \, default 1024);
#X text 572 394 number of points in analysis window (power of 2 \,
128-2048);
#X msg 449 406 npoints 128;
#X msg 451 117 amp-range 70 90;
#X obj 440 662 pack 0 0;
#X obj 569 20 r startaudio;
#X obj 338 526 spigot~;
#X obj 335 413 adc~ 1;
#X obj 542 655 ftom;
#X obj 413 594 int;
#X msg 450 385 npoints 8192;
#X obj 483 499 metro 40;
#X obj 503 470 tgl 15 0 empty empty empty 17 7 0 10 -262144 -1 -1 0
1;
#X obj 108 704 hsl 144 15 -127 127 0 0 empty empty empty -2 -8 0 10
-262144 -1 -1 8000 1;
#X obj 415 618 + 0;
#X obj 445 690 outlet;
#X obj 89 673 route 48 50 52 53 55 57 59 60 62 64 65 67 69 71 72;
#X obj 174 719 bng 10 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X obj 184 719 bng 10 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X obj 194 719 bng 10 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X obj 204 719 bng 10 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X obj 214 719 bng 10 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X obj 224 719 bng 10 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X obj 234 719 bng 10 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X obj 244 719 bng 10 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X obj 105 719 bng 10 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X obj 115 719 bng 10 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X obj 125 719 bng 10 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X obj 135 719 bng 10 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X obj 144 719 bng 10 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X obj 154 719 bng 10 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X obj 164 719 bng 10 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X obj 89 645 spigot;
#X obj 254 704 tgl 25 0 empty empty empty 17 7 0 10 -262144 -1 -1 1
1;
#X obj 417 556 fiddle~ 1024 1 20 3;
#X text 107 621 midinote correction;
#X obj 285 562 r \$0-midinote_offset;
#X obj 87 764 s \$0-midinote_offset;
#X text 399 698 comment;
#X obj 87 740 int;
#X obj 409 639 moses 0;
#X obj 80 704 tgl 25 0 \$0-start empty empty 17 7 0 10 -262144 -1 -1
0 1;
#X obj 250 437 r \$0-start;
#X obj 655 38 r \$0-start;
#X connect 0 0 42 0;
#X connect 1 0 68 0;
#X connect 2 0 0 0;
#X connect 2 1 3 0;
#X connect 2 2 6 0;
#X connect 19 0 68 0;
#X connect 20 0 68 0;
#X connect 21 0 68 0;
#X connect 27 0 68 0;
#X connect 28 0 68 0;
#X connect 29 0 68 0;
#X connect 36 0 68 0;
#X connect 37 0 68 0;
#X connect 38 0 49 0;
#X connect 38 0 66 0;
#X connect 39 0 9 0;
#X connect 40 1 68 0;
#X connect 41 0 40 0;
#X connect 42 0 43 0;
#X connect 43 0 48 0;
#X connect 44 0 68 0;
#X connect 45 0 68 0;
#X connect 46 0 45 0;
#X connect 47 0 73 0;
#X connect 48 0 74 0;
#X connect 50 0 59 0;
#X connect 50 1 60 0;
#X connect 50 2 61 0;
#X connect 50 3 62 0;
#X connect 50 4 63 0;
#X connect 50 5 64 0;
#X connect 50 6 65 0;
#X connect 50 7 51 0;
#X connect 50 8 52 0;
#X connect 50 9 53 0;
#X connect 50 10 54 0;
#X connect 50 11 55 0;
#X connect 50 12 56 0;
#X connect 50 13 57 0;
#X connect 50 14 58 0;
#X connect 66 0 50 0;
#X connect 67 0 66 1;
#X connect 68 0 38 1;
#X connect 68 4 2 0;
#X connect 70 0 48 1;
#X connect 73 0 71 0;
#X connect 74 1 38 0;
#X connect 76 0 40 1;
#X connect 77 0 9 0;
#X coords 0 -1 1 1 209 33 2 75 700;
